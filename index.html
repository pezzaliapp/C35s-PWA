<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
  <title>Ponte 2 Colonne — C3.5S (PWA v2)</title>
  <meta name="theme-color" content="#0f172a">
  <link rel="manifest" href="./manifest.webmanifest">
  <link rel="icon" href="./icons/icon-192.png">
  <style>
    :root{
      --bg:#0b1022; --card:#111735; --ink:#f1f4ff; --muted:#9fb0d9;
      --cta:#22c55e; --line:#1d2a55; --focus:#2dd4bf; --warn:#f59e0b; --bad:#ef4444;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{ margin:0; font:15px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Arial; color:var(--ink); background:radial-gradient(1200px 600px at 20% -10%,#12204b 0%,transparent 60%) , #0b1022; }
    header{display:flex;gap:12px;align-items:center;padding:14px 16px;border-bottom:1px solid var(--line);position:sticky;top:0;background:#0b1022d0;backdrop-filter: blur(8px)}
    header h1{font-size:16px;margin:0}
    main{max-width:1200px;margin:0 auto;padding:16px;display:grid;grid-template-columns:1fr 400px;gap:16px}
    .card{background:linear-gradient(180deg,#111735 0%,#0f1733 100%);border:1px solid var(--line);border-radius:14px;padding:16px}
    h2{margin:0 0 10px 0;font-size:18px}
    label{display:block;font-size:12px;color:var(--muted);margin-bottom:4px}
    input,select,button,textarea{ width:100%;padding:10px 12px;border-radius:10px;border:1px solid var(--line); background:#0c1330;color:var(--ink);outline:none;}
    input:focus,select:focus,textarea:focus{border-color:var(--focus);box-shadow:0 0 0 3px #2dd4bf22}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    .muted{color:var(--muted);font-size:13px}
    .kpi{display:flex;gap:10px;flex-wrap:wrap}
    .pill{padding:6px 10px;border:1px solid var(--line);border-radius:999px;font-size:12px;background:#0c1330}
    .tabs{display:flex;gap:8px;margin-bottom:12px}
    .tab{padding:8px 12px;border:1px solid var(--line);border-radius:999px;background:#0c1330;cursor:pointer}
    .tab.active{border-color:var(--focus);box-shadow:0 0 0 3px #2dd4bf22}
    .actions{display:flex;gap:10px;margin-top:12px}
    canvas{width:100%;height:520px;background:#0c1330;border-radius:12px;border:1px solid var(--line)}
    @media (max-width:1000px){main{grid-template-columns:1fr}}
    .legend{display:flex;gap:10px;flex-wrap:wrap;margin-top:8px}
    .chip{padding:6px 10px;border:1px solid var(--line);border-radius:999px;background:#0c1330;font-size:12px}
  </style>
</head>
<body>
  <header>
    <img src="./icons/icon-192.png" alt="icon" width="28" height="28">
    <h1>Ponte 2 Colonne — C3.5S (3.5 t) • v2</h1>
    <span class="muted">PWA offline • verifiche, ancoranti & layout</span>
  </header>

  <main>
    <section class="card">
      <div class="tabs">
        <button id="tabVer" class="tab active">Verifiche</button>
        <button id="tabLay" class="tab">Layout</button>
      </div>

      <div id="paneVer">
        <h2>Verifiche rapide</h2>
        <div class="kpi">
          <span class="pill">Portata 3500 kg</span>
          <span class="pill">H min 100 mm</span>
          <span class="pill">H max 1970 mm</span>
          <span class="pill">H overall 4250 mm</span>
          <span class="pill">H sotto traversa 4248 mm</span>
          <span class="pill">Interasse 2700 mm</span>
          <span class="pill">Largh. tot 3350 mm</span>
          <span class="pill">Base 620 mm</span>
          <span class="pill">Bracci 690–1325 mm</span>
        </div>

        <h3 style="margin-top:14px">Veicolo</h3>
        <div class="row">
          <div>
            <label>Massa (kg)</label>
            <input id="mass" type="number" min="500" max="4500" step="10" value="1800">
          </div>
          <div>
            <label>Altezza min punti presa (mm)</label>
            <input id="clearance" type="number" min="80" max="400" step="5" value="120">
          </div>
        </div>
        <div class="row" style="margin-top:10px">
          <div>
            <label>Altezza veicolo (tetto, mm)</label>
            <input id="vehHeight" type="number" min="1400" max="2500" step="10" value="1750">
          </div>
          <div>
            <label>Sollevamento desiderato (mm)</label>
            <input id="desiredLift" type="number" min="200" max="1970" step="10" value="1700">
          </div>
        </div>

        <h3 style="margin-top:14px">Installazione</h3>
        <div class="row">
          <div>
            <label>Spessore pavimento (mm)</label>
            <input id="slab" type="number" min="120" max="500" step="5" value="180">
          </div>
          <div>
            <label>Classe calcestruzzo</label>
            <select id="concrete"><option>C25/30</option><option selected>C30/37</option><option>C35/45</option></select>
          </div>
        </div>
        <div class="row" style="margin-top:10px">
          <div>
            <label>Configurazione</label>
            <select id="variant"><option>Senza basamento</option><option>Con basamento (trave/platea)</option></select>
          </div>
          <div>
            <label>H sotto traversa (mm)</label>
            <input id="freeHeight" type="number" min="2000" max="4300" step="1" value="4248">
          </div>
        </div>

        <h3 style="margin-top:14px">Ancoranti (per colonna)</h3>
        <div class="row">
          <div>
            <label>Numero ancoranti</label>
            <input id="ancN" type="number" min="4" max="8" value="5">
          </div>
          <div>
            <label>Tipo</label>
            <select id="ancType"><option selected>M16</option><option>M20</option></select>
          </div>
        </div>
        <div class="row" style="margin-top:10px">
          <div>
            <label>Profondità foro (mm)</label>
            <input id="ancDepth" type="number" min="80" max="250" value="140">
          </div>
          <div>
            <label>Coppia serraggio (Nm)</label>
            <input id="ancTorque" type="number" min="60" max="250" value="120">
          </div>
        </div>
        <div class="row" style="margin-top:10px">
          <div>
            <label>Capacità amm. trazione (kN) — da scheda ETA</label>
            <input id="ancNt" type="number" step="0.1" value="12.0">
          </div>
          <div>
            <label>Capacità amm. taglio (kN) — da scheda ETA</label>
            <input id="ancVt" type="number" step="0.1" value="8.0">
          </div>
        </div>

        <div class="actions">
          <button id="runChecks">Esegui verifiche</button>
          <button id="exportJSON">Esporta report JSON</button>
        </div>
        <pre id="out" class="muted" style="white-space:pre-wrap;margin-top:10px"></pre>
      </div>

      <div id="paneLay" style="display:none">
        <h2>Layout officina</h2>
        <p class="muted">Area predefinita: <b>6000×7000 mm</b>. Trascina gli oggetti, ruota con <b>R</b>, elimina con <b>Del</b>. Esporta PNG/JSON.</p>
        <div class="row">
          <div>
            <label>Larghezza area (mm)</label>
            <input id="roomW" type="number" value="6000">
          </div>
          <div>
            <label>Profondità area (mm)</label>
            <input id="roomH" type="number" value="7000">
          </div>
        </div>
        <div class="row" style="margin-top:10px">
          <div>
            <label>Scala (mm per pixel)</label>
            <input id="scale" type="number" value="10">
          </div>
          <div>
            <label>Nuovo oggetto</label>
            <select id="toolType"><option value="lift">Ponte C3.5S</option><option value="bench">Banco</option><option value="lane">Corsia</option><option value="comp">Compressore</option></select>
          </div>
        </div>
        <div class="actions">
          <button id="addTool">Aggiungi</button>
          <button id="exportPNG">Esporta PNG</button>
          <button id="saveLayout">Salva layout (JSON)</button>
          <button id="loadLayout">Carica layout (JSON)</button>
          <input id="layoutFile" type="file" accept="application/json" style="display:none">
        </div>
        <canvas id="plan" width="900" height="520"></canvas>
        <div class="legend">
          <span class="chip">Ponte (interasse 2700, largh. 3350)</span>
          <span class="chip">Banco 2000×800</span>
          <span class="chip">Corsia 1000×6000</span>
          <span class="chip">Compressore 800×800</span>
        </div>
      </div>
    </section>

    <aside class="card">
      <h2>Note</h2>
      <p class="muted">Queste verifiche sono <b>preliminari</b> e non sostituiscono i calcoli/relazioni di un tecnico abilitato né le schede del produttore (EN 1493, ETA ancoranti, ecc.).</p>
      <textarea id="notes" rows="10" placeholder="Annotazioni, opzioni, accessori, condizioni di posa..."></textarea>
    </aside>
  </main>

  <script src="./app.js"></script>
</body>
</html>
